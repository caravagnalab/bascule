<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Survival analysis on a skin cancer cohort • bascule</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Survival analysis on a skin cancer cohort">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bascule</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/bascule.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/1.Inference.html">Inference with BASCULE</a></li>
    <li><a class="dropdown-item" href="../articles/2.Fit_breast_data.html">Real data analysis on a breast cancer cohort</a></li>
    <li><a class="dropdown-item" href="../articles/3.Survival_Analysis.html">Survival analysis on a skin cancer cohort</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Survival analysis on a skin cancer cohort</h1>
            
      

      <div class="d-none name"><code>3.Survival_Analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="load-package">Load package<a class="anchor" aria-label="anchor" href="#load-package"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html" class="external-link">survminer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">forestmodel</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/caravagnalab/bascule" class="external-link">bascule</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-bascule-fit-object-and-clinical-metadata">Load BASCULE fit object and clinical metadata<a class="anchor" aria-label="anchor" href="#load-bascule-fit-object-and-clinical-metadata"></a>
</h2>
<p>We utilized a fit object of the skin cancer dataset from the
International Cancer Genome Consortium (ICGC) cohort, which is readily
available within the package and can be loaded using the command
<code>data("skin_fit")</code>.</p>
<p>Subsequent post-processing involved merging related clusters and
mapping the de novo inferred mutational signatures to a predefined set
of known signatures from the COSMIC (Catalogue of Somatic Mutations in
Cancer) database and Degasperi et al. study.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"skin_fit"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">x_orig</span> <span class="op">=</span> <span class="fu"><a href="../reference/merge_clusters.html">merge_clusters</a></span><span class="op">(</span><span class="va">skin_fit</span>, cutoff<span class="op">=</span><span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/convert_dn_names.html">convert_dn_names</a></span><span class="op">(</span><span class="va">x_orig</span>, reference_cat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>SBS<span class="op">=</span><span class="va">Degasperi_SBS</span><span class="op">)</span>, cutoff<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/convert_dn_names.html">convert_dn_names</a></span><span class="op">(</span><span class="va">x</span>, reference_cat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>SBS<span class="op">=</span><span class="va">COSMIC_sbs_filt</span><span class="op">)</span>, cutoff<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p>Clinical metadata corresponding to the skin cancer cohort were
imported using <code>data("skin_clinical")</code> and matched to the
genomic data based on unique patient identifiers. The clinical metadata
includes the following variables:</p>
<ul>
<li>PATIENT: Unique patient identifier (ID)</li>
<li>TISSUE: Cancerous tissue type</li>
<li>GENDER: Biological sex of the patient</li>
<li>OS_STATUS: Overall survival status (alive or deceased)</li>
<li>OS_YEARS: Time to event (measured as the duration until death, if
applicable)</li>
<li>CLUSTER: Cluster assignment as determined by the BASCULE
algorithm</li>
<li>AGE: Age of the patient at diagnosis</li>
</ul>
<p>We defined a function called <code>sync_metadata</code> which gets
BASCULE object and corresponding clinical metadata as input and
orchestrate and merge those files and based on the patients IDs.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"skin_metadata"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sync_metadata</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">clinical_data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">exp</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_exposure.html">get_exposure</a></span><span class="op">(</span><span class="va">x</span>, add_groups<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="st">"SBS"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span><span class="op">&gt;=</span><span class="fl">20</span><span class="op">)</span>, <span class="va">value</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>   <span class="co"># keep only clusters with 20 or more members</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">clusters_list</span> <span class="op">=</span> <span class="va">exp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">clusters</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unique</span> </span>
<span></span>
<span>  <span class="va">samples_list</span> <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">exp</span><span class="op">$</span><span class="va">samples</span><span class="op">)</span>, </span>
<span>    y <span class="op">=</span> <span class="va">clinical_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">TISSUE</span><span class="op">==</span><span class="st">"Skin"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">PATIENT</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unique</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">clinical_data</span> <span class="op">=</span> <span class="va">clinical_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">PATIENT</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">samples_list</span><span class="op">)</span></span>
<span>  <span class="va">exp</span> <span class="op">=</span> <span class="va">exp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">samples</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">samples_list</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">cluster_assignment</span> <span class="op">=</span> <span class="va">exp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">samples</span>, <span class="va">clusters</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">distinct</span> <span class="co"># get unique sample-cluster assignment</span></span>
<span>  <span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">clinical_data</span>, y<span class="op">=</span><span class="va">cluster_assignment</span>, by.x<span class="op">=</span><span class="st">"PATIENT"</span>, by.y<span class="op">=</span><span class="st">"samples"</span>, all.x<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># merge with clinical data</span></span>
<span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">GENDER</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">GENDER</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">OS_STATUS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">OS_STATUS</span><span class="op">==</span><span class="st">"DECEASED"</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">==</span><span class="st">"clusters"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"CLUSTER"</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">CLUSTER</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">CLUSTER</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>AGE_GROUP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">AGE</span><span class="op">&gt;</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">AGE</span><span class="op">)</span>, <span class="st">"old"</span>, <span class="st">"young"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">AGE_GROUP</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">AGE_GROUP</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">CLUSTER</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"exp"</span><span class="op">=</span><span class="va">exp</span>, <span class="st">"df"</span><span class="op">=</span><span class="va">df</span>, <span class="st">"cls"</span><span class="op">=</span><span class="va">clusters_list</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">obj</span> <span class="op">=</span> <span class="fu">sync_metadata</span><span class="op">(</span><span class="va">x</span>, <span class="va">skin_metadata</span><span class="op">)</span></span>
<span><span class="va">exp</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">exp</span> <span class="co"># exposure matrix in long format (removed clusters with less than 20 samples)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">obj</span><span class="op">$</span><span class="va">df</span> <span class="co"># clinical data (samples from clinical data are mapped with samples from samples from bascule object)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">AGE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>AGE<span class="op">=</span><span class="va">AGE_GROUP</span><span class="op">)</span> <span class="co"># remove age column from metadata</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploratory-analysis-exposures-and-de-novo-signatures">Exploratory analysis (exposures and de novo signatures)<a class="anchor" aria-label="anchor" href="#exploratory-analysis-exposures-and-de-novo-signatures"></a>
</h2>
<p>Analysing n=259 samples, two clusters (samples belonging to clusters
with less than or equal 20 members eliminated) and 10 mutational
signatures, include eight established signatures SBS1, SBS3, SBS5,
SBS7a, SBS7c, SBS7d, SBS18 and SBS137 from COSMIC and Degasperi study,
alongside two de novo signatures SBSD4 and SBSD8 detected using the
BASCULE framework.</p>
<p>Cluster G1, comprising a smaller subset of samples (n=37), exhibits a
heterogeneous mutational profile, predominantly enriched in age-related
signatures SBS1 and SBS5, along with SBS3 and SBS18 which has been
associated with homologous recombination deficiency and damage by
reactive oxygen species. This distinct mutational composition suggests
an etiology that diverges from the canonical ultraviolet (UV) damage
pathway. Additionally, SBSD8 contributes to the mutational landscape of
cluster G1, with some samples displaying elevated proportions of these
signatures.</p>
<p>In contrast, cluster G11, encompassing the majority of samples
(n=190), is primarily characterized by the SBS7 family (SBS7a, SBS7c and
SBS7d), strongly indicative of UV-induced mutagenesis, aligning with the
well-established role of UV exposure in the pathogenesis of skin cancers
such as melanoma. Notably, signature SBS137 (from Degasperi catalogue),
currently with unknown aetiology, is present, and the contribution of
the de novo signature SBSD4 is more pronounced in G11 than in G1. The
presence of novel signatures SBSD4 and SBSD8 identified via BASCULE
suggests the existence of previously uncharacterised mutagenic processes
within this cohort.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_exposures.html">plot_exposures</a></span><span class="op">(</span><span class="va">x</span>, clusters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G11"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="3.Survival_Analysis_files/figure-html/unnamed-chunk-4-1.png" width="1152"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_signatures.html">plot_signatures</a></span><span class="op">(</span><span class="va">x</span>, signames<span class="op">=</span><span class="fu"><a href="../reference/get_denovo_signames.html">get_denovo_signames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="3.Survival_Analysis_files/figure-html/unnamed-chunk-5-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="kaplan-meier-analysis">Kaplan-Meier analysis<a class="anchor" aria-label="anchor" href="#kaplan-meier-analysis"></a>
</h2>
<p>In this study of n=259 skin cancer samples, we identified ten
mutational signatures within two clusters, including the known
established signatures like SBS1 (clock-like), SBS5 (clock-like) and
SBS7 family (UV-light).</p>
<p>Kaplan-Meier survival analysis revealed distinct survival trends
between the clusters (log-rank p=0.033). Cluster G11, which was enriched
for SBS7 signatures, exhibited better survival compared to G1.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">OS_YEARS</span>, event<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">OS_STATUS</span><span class="op">)</span> <span class="op">~</span> <span class="va">CLUSTER</span>, data<span class="op">=</span><span class="va">df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html" class="external-link">ggsurvplot</a></span><span class="op">(</span></span>
<span>  fit<span class="op">=</span><span class="va">fit</span>, </span>
<span>  data<span class="op">=</span><span class="va">df</span>, </span>
<span>  size<span class="op">=</span><span class="fl">1</span>, </span>
<span>  pval<span class="op">=</span><span class="cn">TRUE</span>, <span class="co"># show log-rank test p-value</span></span>
<span>  risk.table<span class="op">=</span><span class="cn">TRUE</span>, <span class="co"># add risk table below plot</span></span>
<span>  risk.table.col<span class="op">=</span><span class="st">'strata'</span>, </span>
<span>  legend.labs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G1"</span>, <span class="st">"G11"</span><span class="op">)</span>, </span>
<span>  title<span class="op">=</span><span class="st">"Kaplan-Meier Survival Curves"</span>, </span>
<span>  xlab<span class="op">=</span><span class="st">"Time (Years)"</span>, </span>
<span>  ylab<span class="op">=</span><span class="st">"Survival Probability"</span>, </span>
<span>  legend.title<span class="op">=</span><span class="st">"Cluster"</span>, </span>
<span>  pval.size<span class="op">=</span><span class="fl">3</span>, </span>
<span>  fontsize<span class="op">=</span><span class="fl">4</span>, </span>
<span>  ggtheme<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="3.Survival_Analysis_files/figure-html/unnamed-chunk-6-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="cox-proportional-hazards-analysis">Cox proportional hazards analysis<a class="anchor" aria-label="anchor" href="#cox-proportional-hazards-analysis"></a>
</h2>
<p>In multivariate Cox regression, with G1 as reference due to its
lowest survival outcomes, cluster G11 showed a trend toward a protective
effect (n=190, hazard ratio=0.63, 95% CI: 0.39-1.02, p=0.059).</p>
<p>This finding however was borderline significant, possibly because of
the effect of age which significantly influenced the hazard: younger
patients experienced a 44% reduction in risk relative to older
individuals (n=114, hazard ratio=0.56, 95% CI: 0.40-0.80, p=0.001),
whereas gender did not significantly affect the outcome.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">format</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/forestmodel/man/forest_model_format_options.html" class="external-link">forest_model_format_options</a></span><span class="op">(</span></span>
<span>    colour<span class="op">=</span><span class="st">"black"</span>,</span>
<span>    color<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    shape<span class="op">=</span><span class="fl">15</span>,</span>
<span>    text_size<span class="op">=</span><span class="fl">5</span>,</span>
<span>    point_size<span class="op">=</span><span class="fl">6</span>,</span>
<span>    banded<span class="op">=</span><span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">cox_model</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span>time<span class="op">=</span><span class="va">OS_YEARS</span>, event<span class="op">=</span><span class="va">OS_STATUS</span><span class="op">)</span> <span class="op">~</span> <span class="va">GENDER</span> <span class="op">+</span> <span class="va">CLUSTER</span> <span class="op">+</span> <span class="va">AGE</span>, data<span class="op">=</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/forestmodel/man/forest_model.html" class="external-link">forest_model</a></span><span class="op">(</span><span class="va">cox_model</span>, format_options<span class="op">=</span><span class="va">format</span>, factor_separate_line<span class="op">=</span><span class="cn">T</span>, recalculate_width<span class="op">=</span><span class="cn">F</span>, recalculate_height<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Cox proportional hazards model (forest plot)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>axis_titles<span class="op">=</span><span class="st">"collect"</span>, axes<span class="op">=</span><span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="3.Survival_Analysis_files/figure-html/unnamed-chunk-7-1.png" width="1152"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Elena Buscaroli, Azad Sadr, Giulio Caravagna.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
